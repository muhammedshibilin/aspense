<%- include("../layouts/user/header.ejs") %>

<div
    class="breadcumb-area ptb--100 ptb_md--100 ptb_sm--100  bg_image bg_image--3">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="inner text-center">
                    <h2 class="font--40 mb--0">Product Details</h2>
                </div>
            </div>
        </div>
    </div>
    <div class="breadcrumbs"
        style="font-size: 18px; margin-bottom: 5px; margin-left: 30px;">
        <a href="/"
            style="text-decoration: none; color: #333; font-weight: bold;">Home</a>
        &gt;
        <a href="/product-details"
            style="text-decoration: none; color: #333; font-weight: bold;">Product
            Details</a> &gt;
        <span style="color: #999;"><%= productData.name %></span>
    </div>

    <!-- End Breadumb Area -->

    <div class="main-wrapper">
        <!-- Start Single Product -->
        <div
            class="brook-single-product plr--160 plr_lg--100 plr_md--50 plr_sm--50">
            <div class="single-product-wrapper ptb--120">
                <div class="row">

                    <div class="col-lg-6 col-md-6 col-sm-12 col-12">
                        <div class="single-product-left-side">
                            <div class="product__details__container">
                                <div class="tab_container big_img_container">
                                    <% productData.images.forEach((image, index) => { %>
                                        <div class="big_img tab-pane fade <%= index === 0 ? 'show active' : '' %>" id="img<%= index + 1 %>" role="tabpanel">
                                            <div class="zoom-container">
                                                <img class="w-100 zoomio"
                                                     id="zoomedImage<%= index + 1 %>"
                                                     src="/images/product/original/<%= image %>"
                                                     data-zoom-image="/images/product/original/<%= image %>"
                                                     alt="<%= productData.name %>"  
                                                     style="height: 500px;"
                                                     loading="lazy">
                                            </div>
                                        </div>
                                    <% }); %>
                                </div>
                                <div class="sm_roduct_nav nav nav-tabs" role="tablist">
                                    <% productData.images.forEach((image, index) => { %>
                                        <a class="<%= index === 0 ? 'active' : '' %>" id="nav-img-tab<%= index + 1 %>"
                                           data-toggle="tab" href="#img<%= index + 1 %>"
                                           role="tab"
                                           aria-controls="img<%= index + 1 %>"
                                           aria-selected="<%= index === 0 ? 'true' : 'false' %>">
                                            <img src="/images/product/original/<%= image %>" alt="<%= productData.name %>" style="width: 80px; height: 100px;" loading="lazy">
                                        </a>
                                    <% }); %>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-6 col-sm-12 col-12 mt_sm--40">
                        <div class="single-product-details-side">
                            <div class="product-details">
                                <div class="inner">
                                    <div class="header">
                                        <div class="product-badges">
                                            <span>Hot</span>
                                        </div>
                                        <h4
                                            class="heading heading-h4 text-black "><%=
                                            productData.name %> </h4>
                                    </div>
                                    <div class="price">
                                     
                                        <p class="theme-color text-black"
                                            style=" color: #999; font-size: 12px;">$<%=
                                            productData.price %></p>
                                    </div>
                                    <% if(productData.quantity <= 4){ %>
                                    <p
                                        style="color: black; font-size: 20px; font-weight: bold;">
                                        only <%= productData.quantity %> pieces
                                        available </p>
                                    <% } else { %>
                                    <p
                                        style="color: black; font-size: 20px;">choose
                                        as your order !</p>
                                    <% } %>

                                    <div class="description">
                                        <p class="bk_pra"><%=
                                            productData.discription %>
                                        </p>
                                    </div>
                                    <div class="quenty-container">
                                        <div class="quenty-button">
                                            <h6
                                                class="heading heading-h6">QUANTITY</h6>
                                            <input type="number"
                                                class="input-text qty text"
                                                step="1"
                                                min="1" name="quantity"
                                                value="1"
                                                title="Qty" id="quantity">
                                        </div>

                                        <div class="product-action">
                                            <a class="addtocart"
                                                onclick="toCart('<%= productData._id %>')"><i
                                                    class="fa fa-cart-arrow-down"></i><span>Add
                                                    to cart</span></a>
                                            <a class="wislist"
                                                href="/wishlist"></a>
                                        </div>
                                    </div>

                                    <div class="product-meta">
                                        <div class="meta-item">
                                            <h6
                                                class="heading heading-h6">CATEGORY:</h6>

                                            <div class="item-list">
                                                <a href="#"> <%=
                                                    productData.category.name
                                                    %></a>
                                            </div>
                                        </div>
                                        <div class="meta-item">
                                            <h6
                                                class="heading heading-h6">TAG:</h6>
                                            <div class="item-list">
                                                <a href="#">standard,</a>
                                                <a href="#">business,</a>
                                                <a href="#">multipurpose,</a>
                                                <a href="#">createtive,</a>
                                                <a href="#">clean,</a>
                                                <a href="#">themplate,</a>
                                                <a href="#">theme,</a>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Single Product -->

        <!-- Start Product Review -->
        <div class="product_review pb--80 pb_md--80 pb_sm--60">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="description_nav nav nav-tabs d-block"
                            role="tablist">
                            <a class="active" id="descrip-tab" data-toggle="tab"
                                href="#descrip" role="tab"
                                aria-controls="descrip"
                                aria-selected="true">Description</a>
                            <a id="nav-review" data-toggle="tab" href="#review"
                                role="tab" aria-controls="review"
                                aria-selected="false">Reviews</a>
                        </div>
                    </div>
                </div>
                <div class="tab_container">
                    <div class="single_review_content tab-pane fade show active"
                        id="descrip" role="tabpanel">
                        <div class="content">
                            <p><%= productData.discription %> </p>
                        </div>
                    </div>
                    <div class="single_review_content tab-pane fade" id="review"
                        role="tabpanel">
                        <div class="classs__review__inner">
                            <h4>Be the first to review “<%= productData.name
                                %>”</h4>
                            <h1>reviews</h1>

                            <div style="background-color: antiquewhite;">
                                <% reviews.forEach( review => { %>
                                <p style="color: black;"><%=review.name %>:<%=
                                    review.review %></p>
                                <% }) %>

                            </div>
                            <p>Your E-mail Address Will not be published.
                                Required
                                field are marked *</p>
                            <span>Your rating</span>
                            <ul class="rating">
                                <li><i class="fa fa-star"></i></li>
                                <li><i class="fa fa-star"></i></li>
                                <li><i class="fa fa-star"></i> </li>
                                <li><i class="fa fa-star"></i></li>
                                <li><i class="fa fa-star"></i></li>
                            </ul>
                            <form action="/review?_id=<%= productData._id %>"
                                method="post">
                                <div class="input__box">
                                    <span>Your Review *</span>
                                    <textarea name="review"></textarea>
                                </div>
                                <div class="input__box">
                                    <span>Name</span>
                                    <input type="text" name="name">
                                </div>
                                <div class="input__box">
                                    <span>E-mail</span>
                                    <input type="email" name="email">
                                </div>
                                <button type="submit">post the review</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Product Review -->
        <!-- Start Product Area -->
        <div class="feature-product-area bg-color pb--120 pb_md--80 pb_sm--80"
            data-bg-color="#fff">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="section-title text-center">
                            <h2 class="title">Related Products</h2>
                            <img src="user/images/logo/shape.png"
                                alt="Shape Images">
                        </div>
                    </div>
                </div>
                <div class="row mt--20">
                    <!-- Start Single Product -->
                    <% relatedImg.forEach( related => { %>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-12 mt--30">

                        <div class="product">
                            <div class="inner">
                                <div class="thumbnail">
                                    <a
                                        href="/product-details?_id=<%= related._id %>">
                                        <img
                                            src="/images/product/original/<%= related.images[0]%>"
                                            alt="<%= related.name %>" loading="lazy">
                                    </a>
                                </div>
                                <div class="product-hover-action">
                                    <div class="hover-inner">
                                        <a title="Quick View" class="quickview"
                                            href="#"><i
                                                class="fa fa-search"></i></a>
                                        <a href><i
                                                class="fa fa-cart-plus"></i></a>
                                        <a href="wishlist.html"><i
                                                class="fa fa-heart-o"></i></a>
                                        <a href="compare.html"><i
                                                class="fa fa-repeat"></i></a>
                                    </div>
                                </div>
                            </div>
                            <div class="content">
                                <h2><a
                                        href="/product-details?_id=<%=productData._id %>"><%=
                                        related.name %></a></h2>
                                <span class="prize">$<%= related.price %>.00</span>
                            </div>
                        </div>

                    </div>
                    <!-- End Single Product -->

                    <!-- Start Single Product -->
                    <% }) %>
                </div>
            </div>
        </div>
        <!-- End Product Area -->

        <!-- Quick View Modal -->
        <div class="quick-view-modal">
            <div class="quick-view-modal-inner">
                <div class="container">
                    <div class="product-details">
                        <!-- Product Details Left -->
                        <div class="product-details-left">
                            <div
                                class="product-details-images slider-navigation-2">
                                <a href="#">
                                    <img class="w-100"
                                        src="user/images/product/product-01.jpg"
                                        alt="product image">
                                </a>
                                <a href="#">
                                    <img class="w-100"
                                        src="user/images/product/product-02.jpg"
                                        alt="product image">
                                </a>
                                <a href="#">
                                    <img class="w-100"
                                        src="user/images/product/product-03.jpg"
                                        alt="product image">
                                </a>
                                <a href="#">
                                    <img class="w-100"
                                        src="user/images/product/product-04.jpg"
                                        alt="product image">
                                </a>
                                <a href="#">
                                    <img class="w-100"
                                        src="user/images/product/product-05.jpg"
                                        alt="product image">
                                </a>
                            </div>
                            <div
                                class="product-details-thumbs slider-navigation-2">
                                <img src="user/images/product/product-01.jpg"
                                    alt="product image thumb">
                                <img src="user/images/product/product-02.jpg"
                                    alt="product image thumb">
                                <img src="user/images/product/product-03.jpg"
                                    alt="product image thumb">
                                <img src="user/images/product/product-04.jpg"
                                    alt="product image thumb">
                                <img src="user/images/product/product-05.jpg"
                                    alt="product image thumb">
                            </div>
                        </div>
                        <!--// Product Details Left -->

                        <!-- Product Details Right -->
                        <div class="product-details-right">
                            <h5 class="product-title">Demo Product Name</h5>

                            <div class="ratting-stock-availbility">
                                <div class="ratting-box">
                                    <span><i class="fa fa-star"></i></span>
                                    <span><i class="fa fa-star"></i></span>
                                    <span><i class="fa fa-star"></i></span>
                                    <span><i class="fa fa-star"></i></span>
                                    <span><i class="fa fa-star"></i></span>
                                </div>
                                <span class="stock-available">In stock</span>
                            </div>

                            <p>Lorem ipsum dolor sit amet, consectetur
                                adipiscing
                                elit. Nam fringilla augue nec est
                                tristique auctor. Donec non est at libero
                                vulputate
                                rutrum. Morbi ornare lectus quis
                                justo gravida semper. Nulla tellus mi, vulputate
                                adipiscing cursus eu, suscipit id
                                nulla. adipiscing cursus eu, suscipit id
                                nulla.</p>

                            <div class="price-box">
                                <span class="pricebox-price">£80.00</span>
                            </div>

                            <div class="product-details-quantity">
                                <div class="quantity-select">
                                    <div class="pro-quantity">
                                        <div class="pro-qty"><input type="number"
                                                value="1"></div>
                                    </div>
                                </div>
                                <a href="#" class="add-to-cart-button">
                                    <span>ADD TO CART</span>
                                </a>
                            </div>

                            <div class="product-details-color">
                                <span>Color :</span>
                                <ul>
                                    <li class="red"><span></span></li>
                                    <li class="green checked"><span></span></li>
                                    <li class="blue"><span></span></li>
                                    <li class="black"><span></span></li>
                                </ul>
                            </div>

                            <div class="product-details-size">
                                <span>Size :</span>
                                <ul>
                                    <li class="checked"><span>S</span></li>
                                    <li><span>M</span></li>
                                    <li><span>L</span></li>
                                    <li><span>XL</span></li>
                                    <li><span>XXL</span></li>
                                </ul>
                            </div>

                            <div class="product-details-categories">
                                <span>Categories :</span>
                                <ul>
                                    <li><a href="shop.html">Accessories</a></li>
                                    <li><a href="shop.html">Kids</a></li>
                                    <li><a href="shop.html">Women</a></li>
                                </ul>
                            </div>

                            <div class="product-details-tags">
                                <span>Tags :</span>
                                <ul>
                                    <li><a href="shop.html">Electronic</a></li>
                                    <li><a href="shop.html">Television</a></li>
                                </ul>
                            </div>

                            <div class="product-details-socialshare">
                                <span>Share :</span>
                                <ul>
                                    <li><a class="facebook" href="#"><i
                                                class="fa fa-facebook"></i></a></li>
                                    <li><a class="twitter" href="#"><i
                                                class="fa fa-twitter"></i></a></li>
                                    <li><a class="google-plus" href="#"><i
                                                class="fa fa-google-plus"></i></a></li>
                                    <li><a class="linkedin" href="#"><i
                                                class="fa fa-linkedin"></i></a></li>
                                    <li><a class="instagram" href="#"><i
                                                class="fa fa-instagram"></i></a></li>
                                </ul>
                            </div>
                        </div>
                        <!--// Product Details Right -->

                    </div>
                </div>
            </div>
            <button class="close-quickview-modal"><i
                    class="fa fa-close"></i></button>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.3.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>


function toCart(productId) {

var quantity = parseInt($("#quantity").val());

console.log('quantity from frontend',quantity,productId);

        $.ajax({
            url: "/add-to-cart",
            method: "post",
            data: {
                 productId,
                 quantity
            },
            success: (response) => {  
                if (response.login) {    
                    swal.fire({
                        icon:"error",
                        text:"please login to add product"
                       }).then(()=> {
                        window.location.href = '/login';
                    })
                }else if(response.limit){
                    Swal.fire({
                        icon:"error",
                        text:"you can add only 5 pieces at a time"
                    })
                } 
                else if (response.success) {
                    if (response.newProduct) {
                       swal.fire({
                        icon:"success",
                        text:"added to cart"
                       })
                        $('#reloadArea').load('/shop #reloadArea');
                    }
                } else if (response.exist) {
                        Swal.fire({
                         icon:"warning",
                         text:"product already in cart"
   })
    setTimeout(function () {
        window.location.href = '/cart';
    }, 2000);

                } else if (response.stock) {
                    Swal.fire({
                        icon:'error',
                        text:"product out of stock!.will update soon"
                    })
                    return
                }
            },
            error: (error) => {
                console.error("Error adding to cart:", error);
            },
        });
    }




            </script>

        <script>
        document.addEventListener('DOMContentLoaded', () => {
            $('#zoomedImage1').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square", 
                lensSize: 400 ,
        
                
            });
            $('#zoomedImage2').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square", 
                lensSize: 400 ,
               
            });
            $('#zoomedImage3').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square", 
                lensSize: 400 ,
               
            });
            $('#zoomedImage4').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square",
                lensSize: 400 ,
            
            });
            var lastScrollTop = 0; 
        $(window).scroll(function() {
           
            if ($(this).scrollTop() < lastScrollTop) {
                $('.zoomContainer').remove();
               
                $('#zoomedImage1').elevateZoom({
                    zoomType: "lens",
                    cursor: "crosshair"
                });
                $('#zoomedImage2').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair",
               
            });
            $('#zoomedImage3').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square", 
                lensSize: 400 ,
              
            });
            $('#zoomedImage4').elevateZoom({
                zoomType: "lens",
                cursor: "crosshair", 
                lensShape: "square",
                lensSize: 400 ,
               
            })
        }
            lastScrollTop = $(this).scrollTop();
            var scrollTopValue = $(this).scrollTop(); 
            console.log("Scroll Top Value:", scrollTopValue);

        });
    });
      
        </script>

        <%- include("../layouts/user/footer.ejs") %>