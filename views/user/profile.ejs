<%- include("../layouts/user/header.ejs") %>

<style>
    .profile-container {
      padding: 20px;
      border: black solid 1px;
      border-radius: 15px;
      width: auto;
      margin-bottom: 5rem;
      box-shadow: inset 1px;
    }

    .profile-image {
      position: relative;
      width: 100px; /* Adjust size as needed */
      height: 100px; /* Adjust size as needed */
      border-radius: 50%; /* Creates a rounded shape */
      overflow: hidden; /* Ensures the input and label stay within the rounded shape */
      margin: 0 auto; /* Center the image */
    }

    #file-input {
      position: absolute;
      top: 0;
      left: 0;
      width: 50%;
      height: 50%;
      opacity: 0; /* Hide the default file input */
      cursor: pointer;
    }

    .custom-file-upload {
      position: absolute;
      width: 200px;
      height: 200px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 10px 20px;
      background-image: url("./user/images/bg/bg-image-12.jpg");
      color: #fff;
      border-radius: 50%; /* Creates a rounded shape */
      cursor: pointer;
    }

    .custom-file-upload i {
      margin-right: 5px;
    }

    .profile-details {
      text-align: center;
      margin-top: 20px;
    }
  </style>
<style>
    .profile-info {
        /* Custom styles for the profile field */
        position: relative;
        overflow: hidden;
        display: inline-block;
        border-radius: 50%; /* for round shape */
        width: 150px; /* adjust as needed */
        height: 150px; /* adjust as needed */
        border: 2px dashed #ccc; /* dashed border for styling */
        text-align: center;
        line-height: 150px; /* vertically center text */
        font-size: 16px;
        cursor: pointer; /* make it look clickable */
    }

    .profile-info input[type="file"] {
        /* Custom styles for the profile input field */
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }
</style>

        

    <!-- Start Search Flyover -->
    <div class="search-flyoveray"></div>
    <div class="cart-flyout">
        <div class="cart-flyout-inner">
            <a class="btn-close-cart" href="#">
                <i class="fa fa-times"></i>
            </a>
            <div class="cart-flyout__content">
                <div class="cart-flyout__heading">Shopping Cart</div>
                <div class="widget_shopping_cart_content">
                    <ul class="product_list_widget">
                        <li>
                            <div class="thumb">
                                <img src="assets/images/product/sm-product-01.jpg" alt="product">
                            </div>
                            <div class="content">
                                <h6><a href="/single-product">Boys light blue jacket</a></h6>
                                <div class="quntity">1 × $35.99</div>
                                <button class="remove-btn">×</button>
                            </div>
                        </li>

                        <li>
                            <div class="thumb">
                                <img src="assets/images/product/sm-product-02.jpg" alt="product">
                            </div>
                            <div class="content">
                                <h6><a href="/single-product">Boys light blue jacket</a></h6>
                                <div class="quntity">1 × $35.99</div>
                                <button class="remove-btn">×</button>
                            </div>
                        </li>

                        <li>
                            <div class="thumb">
                                <img src="assets/images/product/sm-product-03.jpg" alt="product">
                            </div>
                            <div class="content">
                                <h6><a href="/single-product">Boys light blue jacket</a></h6>
                                <div class="quntity">1 × $35.99</div>
                                <button class="remove-btn">×</button>
                            </div>
                        </li>

                    </ul>
                </div>
                <p class="minicart__total">Subtotal: <span class="price">164.97</span></p>
                <div class="cart__btn">
                    <a href="/cart">View cart</a>
                    <a href="/checkout">Checkout</a>
                </div>
            </div>
        </div>
    </div>

    <!--end search flyover-->

 <!-- Start Hamburger -->
 <div class="hamburger-area">
    <div class="btn-close-search">
        <button>
            <i class="fa fa-times" aria-hidden="true"></i>
        </button>
    </div>
    <!-- Start Main Menu -->
    <ul class="menu-primary-menu-1 responsive-manu d-block d-xl-none" id="responsive-manu">
        <li><a href="/">Home</a> </li>
        <li><a href="about.html">About</a></li>
        <li class="has-dropdown"><a href="/shop">Shop</a>
            <ul class="sub-menu">
                <li><a href="/shop"><span>Shop</span></a></li>
                <li><a href="/shop-left-sidebar"><span>Shop Left Sidebar</span></a></li>
                <li><a href="/shop-right-sidebar"><span>Shop No Sidebar</span></a></li>
                <li><a href="/product-details"><span>Product Details</span></a></li>
            </ul>
        </li>
        <li class="has-dropdown"><a href="#">Pages</a>
            <ul class="sub-menu">
                <li><a href="/cart"><span>Cart</span></a></li>
                <li><a href="/checkout"><span>Checkout</span></a></li>
                <li><a href="/wishlist"><span>Wishlist</span></a></li>
                <li><a href="/compare"><span>Compare</span></a></li>
                <li><a href="/profile"><span>profile</span></a></li>
                <li><a href="/login"><span>Login</span></a></li>
                <li><a href="/sign-up"><span>sign Up</span></a></li>
            </ul>
        </li>
        <li class="has-dropdown"><a href="/blog">Blog</a>
            <ul class="sub-menu">
                <li><a href="/blog"><span>Blog</span></a></li>
                <li><a href="/blog-left-sidebar"><span>Blog Left Sidebar</span></a></li>
                <li><a href="/blog-details"><span>Blog Details</span></a></li>
            </ul>
        </li>
        <li><a href="/contact">Contact</a></li>
    </ul>
    <!-- End Main Menu -->
</div>
<!-- End Hamburger -->


    <!-- Start Breadumb Area -->
    <div class="breadcumb-area ptb--100 ptb_md--100 ptb_sm--100  bg_image bg_image--3">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="inner text-center">
                        <h2 class="font--40 mb--0">profile</h2>
                        <button class="btn btn-primary "><a href="/logout">logout</a></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Breadumb Area -->
    <div class="main-wrapper">
        <!-- Start My Account Area -->
        <div class="my-account-area pt--120 pb--90">
            <div class="container">
                <div class="row">
                    <div class="ml-auto mr-auto col-lg-12">
                        <div class="checkout-wrapper">
                            <div id="faq" class="panel-group">
                                <div class="panel panel-default">
                                    <div class="container mt-5">
                                        <div class="row justify-content-center">
                                            <div class="col-md-6 profile-container">
                                                <div class="profile-image d-flex justify-content-center align-items-center position-relative rounded-circle" style="width: 150px; height: 150px; overflow: hidden;">
                                                    <!-- Placeholder image -->
                                                    <% if(userData.image){ %>  
                                                    <img src="<%= userData.image %>" alt="Profile Image" class="w-100 h-100">
                                                    <% } else { %>
                                                        <img src="/public/images/product/original/3.jpg" alt="Profile Image" class="w-100 h-100">
                                                   <% } %>
                                                </div>
                                                <div class="profile-details">
                                                    <p>Username: <%= userData.name %></p>
                                                    <p>Email:<%= userData.email %></p>
                                                    <p>Mobile:<%= userData.mobile %></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                      
                                    <div class="panel-heading">
                                        <h5 class="panel-title">
                                            <span>1</span>
                                            <a data-toggle="collapse" data-parent="#faq" href="#my-account-1" class="toggle-edit" data-user-id="<%= userData._id %>">Edit your
                                                account information </a>
                                        </h5>
                                    </div>
                                    <div id="my-account-1" class="panel-collapse collapse show">
                                        <div class="panel-body">
                                            <form enctype="multipart/form-data" action="/edit-profile" method="post" >
                                            <div class="billing-information-wrapper">
                                                <div class="account-info-wrapper">
                                                    <h4>My Account Information</h4>
                                                    <h5>Your Personal Details</h5>
                                                </div>
                                                <div class="row">
                                                   
                                                    
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="profile-info"> <!-- Added a class to target the profile field -->
                                                            <label for="profileImage">Profile Image</label>
                                                            <input type="file" id="profileImage" accept="image/*"> <!-- Added an ID to target the profile input field -->
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6">
                                                        <div class="billing-info">
                                                            <label>username</label>
                                                            <input type="text" id="edit-name" name="name">
                                                        </div>
                                                    </div>
                                                  
                                                    <div class="col-lg-6 col-md-6">
                                                        <div class="billing-info"  name="mobile">
                                                            <label>mobile</label>
                                                            <input type="text" id="edit-mobile" name="mobile">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="billing-info">
                                                            <label>Email</label>
                                                            <input type="email" id="edit-email" name="email">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="billing-info">
                                                            <label>current password</label>
                                                            <input type="text" name="currentPassword" id="edit-current-password">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="billing-info" >
                                                            <label>new password</label>
                                                            <input type="text" id="edit-new-password" name="newPassword">
                                                        </div>
                                                    </div>
                                                   
                                                </div>

                                                <h3><a href="/forgot-password">forgot password?</a></h3>
                                                <div class="billing-back-btn">
                                                    <div class="billing-back">
                                                        <a href="#">
                                                            <i class="fa fa-long-arrow-up"></i> back</a>
                                                    </div>
                                                    <div class="billing-btn" >
                                                        <button type="submit" id="edit-btn" >save</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h5 class="panel-title">
                                            <span>2</span>
                                            <a data-toggle="collapse" data-parent="#faq" href="#my-account-2">Change
                                                your password </a>
                                        </h5>
                                    </div>
                                    <div id="my-account-2" class="panel-collapse collapse">
                                        <div class="panel-body">
                                            <div class="billing-information-wrapper">
                                                <div class="account-info-wrapper">
                                                    <h4>Change Password</h4>
                                                    <h5>Your Password</h5>
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="billing-info">
                                                            <label>Password</label>
                                                            <input type="password">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-12 col-md-12">
                                                        <div class="billing-info">
                                                            <label>Password Confirm</label>
                                                            <input type="password">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="billing-back-btn">
                                                    <div class="billing-back">
                                                        <a href="#">
                                                            <i class="fa fa-long-arrow-up"></i> back</a>
                                                    </div>
                                                    <div class="billing-btn">
                                                        <button type="submit">Continue</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h5 class="panel-title">
                                            <span>3</span>
                                            <a data-toggle="collapse" data-parent="#faq" href="#my-account-3">Modify
                                                your address book entries </a>
                                        </h5>
                                    </div>
                                    <div id="my-account-3" class="panel-collapse collapse">
                                        <div class="panel-body">
                                            <div class="billing-information-wrapper">
                                                <div class="account-info-wrapper">
                                                    <h4>Address Book Entries</h4>
                                                </div>
                                                <div class="entries-wrapper">
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-12 d-flex align-items-center justify-content-center">
                                                            <div class="entries-info text-center">
                                                                <p>Gerald Armstrong </p>
                                                                <p> Address will go here. </p>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-12 d-flex align-items-center justify-content-center">
                                                            <div class="entries-edit-delete text-center">
                                                                <a class="edit" href="#">Edit</a>
                                                                <a href="#">Delete</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="billing-back-btn">
                                                    <div class="billing-back">
                                                        <a href="#">
                                                            <i class="fa fa-long-arrow-up"></i> back</a>
                                                    </div>
                                                    <div class="billing-btn">
                                                        <button type="submit">Continue</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h5 class="panel-title">
                                            <span>4</span>
                                            <a href="wishlist.html">Modify your wish list </a>
                                        </h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End My Account Area -->
    </div>

    <!-- Quick View Modal -->
    <div class="quick-view-modal">
        <div class="quick-view-modal-inner">
            <div class="container">
                <div class="product-details">
                    <!-- Product Details Left -->
                    <div class="product-details-left">
                        <div class="product-details-images slider-navigation-2">
                            <a href="#">
                                <img class="w-100" src="assets/images/product/product-01.jpg" alt="product image">
                            </a>
                            <a href="#">
                                <img class="w-100" src="assets/images/product/product-02.jpg" alt="product image">
                            </a>
                            <a href="#">
                                <img class="w-100" src="assets/images/product/product-03.jpg" alt="product image">
                            </a>
                            <a href="#">
                                <img class="w-100" src="assets/images/product/product-04.jpg" alt="product image">
                            </a>
                            <a href="#">
                                <img class="w-100" src="assets/images/product/product-05.jpg" alt="product image">
                            </a>
                        </div>
                        <div class="product-details-thumbs slider-navigation-2">
                            <img src="assets/images/product/product-01.jpg" alt="product image thumb">
                            <img src="assets/images/product/product-02.jpg" alt="product image thumb">
                            <img src="assets/images/product/product-03.jpg" alt="product image thumb">
                            <img src="assets/images/product/product-04.jpg" alt="product image thumb">
                            <img src="assets/images/product/product-05.jpg" alt="product image thumb">
                        </div>
                    </div>
                    <!--// Product Details Left -->

                    <!-- Product Details Right -->
                    <div class="product-details-right">
                        <h5 class="product-title">Demo Product Name</h5>

                        <div class="ratting-stock-availbility">
                            <div class="ratting-box">
                                <span><i class="fa fa-star"></i></span>
                                <span><i class="fa fa-star"></i></span>
                                <span><i class="fa fa-star"></i></span>
                                <span><i class="fa fa-star"></i></span>
                                <span><i class="fa fa-star"></i></span>
                            </div>
                            <span class="stock-available">In stock</span>
                        </div>

                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam fringilla augue nec est
                            tristique auctor. Donec non est at libero vulputate rutrum. Morbi ornare lectus quis
                            justo gravida semper. Nulla tellus mi, vulputate adipiscing cursus eu, suscipit id
                            nulla. adipiscing cursus eu, suscipit id nulla.</p>

                        <div class="price-box">
                            <span class="pricebox-price">£80.00</span>
                        </div>

                        <div class="product-details-quantity">
                            <div class="quantity-select">
                                <div class="pro-quantity">
                                    <div class="pro-qty"><input type="text" value="1"></div>
                                </div>
                            </div>
                            <a href="#" class="add-to-cart-button">
                                <span>ADD TO CART</span>
                            </a>
                        </div>

                        <div class="product-details-color">
                            <span>Color :</span>
                            <ul>
                                <li class="red"><span></span></li>
                                <li class="green checked"><span></span></li>
                                <li class="blue"><span></span></li>
                                <li class="black"><span></span></li>
                            </ul>
                        </div>

                        <div class="product-details-size">
                            <span>Size :</span>
                            <ul>
                                <li class="checked"><span>S</span></li>
                                <li><span>M</span></li>
                                <li><span>L</span></li>
                                <li><span>XL</span></li>
                                <li><span>XXL</span></li>
                            </ul>
                        </div>

                        <div class="product-details-categories">
                            <span>Categories :</span>
                            <ul>
                                <li><a href="shop.html">Accessories</a></li>
                                <li><a href="shop.html">Kids</a></li>
                                <li><a href="shop.html">Women</a></li>
                            </ul>
                        </div>

                        <div class="product-details-tags">
                            <span>Tags :</span>
                            <ul>
                                <li><a href="shop.html">Electronic</a></li>
                                <li><a href="shop.html">Television</a></li>
                            </ul>
                        </div>

                        <div class="product-details-socialshare">
                            <span>Share :</span>
                            <ul>
                                <li><a class="facebook" href="#"><i class="fa fa-facebook"></i></a></li>
                                <li><a class="twitter" href="#"><i class="fa fa-twitter"></i></a></li>
                                <li><a class="google-plus" href="#"><i class="fa fa-google-plus"></i></a></li>
                                <li><a class="linkedin" href="#"><i class="fa fa-linkedin"></i></a></li>
                                <li><a class="instagram" href="#"><i class="fa fa-instagram"></i></a></li>
                            </ul>
                        </div>
                    </div>
                    <!--// Product Details Right -->

                </div>
            </div>
     

        </div>
        <button class="close-quickview-modal"><i class="fa fa-close"></i></button>
    </div>
    
    <script>
        function previewImage(event) {
          const fileInput = event.target;
          const previewImg = document.getElementById('preview-image');
    
          if (fileInput.files && fileInput.files[0]) {
            const reader = new FileReader();
    
            reader.onload = function(e) {
              previewImg.src = e.target.result;
              previewImg.classList.remove('d-none');
            };
    
            reader.readAsDataURL(fileInput.files[0]);
          }
        }
      </script>
      
<!-- 
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

      <script>
        document.getElementById('edit-btn').addEventListener('click',async (e) =>{
            e.preventDefault()
            const name = document.getElementById('edit-name').value
            const email = document.getElementById('edit-email').value
            const mobile = document.getElementById('edit-mobile').value
            const newPassword = document.getElementById('edit-new-password').value
            const currentPassword = document.getElementById('edit-current-password').value

          try {
            const response = await axios.post('/edit-profile',{
                name,
                email,
                mobile,
                newPassword,
                currentPassword
            })

            if(response.data.passwordLength){
                Swal.fire({
                    icon:'warning',
                    title:'failed',
                    text:'password must be 8 characters'
                })

            }else if(response.data.passwordMatch){
                Swal.fire({
                    icon:'warning',
                    title:'failed',
                    text:'current password is not matching,try again later'
                })
            }else if (response.data.profileEdit){
                Swal.fire({
                icon:'success',
                    title:'success',
                    text:'your profile is edited'
                })
            }else if(response.data.error){
                Swal.fire({
                    icon:'warning',
                    tile:'failed',
                    text:"profile edit is filed please try again" 
                })
            }
            
          } catch (e) {
            console.log('while passing the edit profile input:',e);
          }


        })
      </script>
      -->

    <%- include("../layouts/user/footer.ejs") %>